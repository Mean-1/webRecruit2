<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xxx.server.mapper.JobMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.xxx.server.pojo.Job">
        <id column="id" property="id" />
        <result column="name" property="name" />
        <result column="experience" property="experience" />
        <result column="qualification" property="qualification" />
        <result column="salary" property="salary" />
        <result column="tag" property="tag" />
        <result column="company_id" property="company_id" />
        <result column="posted_at" property="posted_at" />
        <result column="created_at" property="created_at" />
        <result column="updated_at" property="updated_at" />
    </resultMap>

    <resultMap id="getAllJobWithCompany" type="com.xxx.server.pojo.Job" extends="BaseResultMap">
        <collection property="company" ofType="com.xxx.server.pojo.Company">
            <result column="cname" property="name"/>
            <result column="ctag" property="tag"/>
            <result column="size" property="size"/>
            <result column="address" property="address"/>
        </collection>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, name, experience, qualification, salary, tag, company_id, posted_at, created_at, updated_at
    </sql>


    <select id="getAllJob" resultMap="getAllJobWithCompany">
        select
            job.id ,
            job.name ,
            job.experience,
            job.qualification,
            job.salary,
            job.tag ,
            job.posted_at,
            job.created_at,
            job.updated_at,
            company.name as cname,
            company.tag as ctag,
            company.size,
            company.address
        from
            job LEFT JOIN company on job.company_id=company.id
        where
            1=1
        ORDER BY
            job.id
    </select>

</mapper>
